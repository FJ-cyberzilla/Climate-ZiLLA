name: Climate-ZiLLA Health Monitoring

on:
  workflow_dispatch:  # Manual trigger only for testing
  push:
    branches: [ main ]

run-name: Health check by @${{ github.actor }}

jobs:
  health-check:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Debug - List files
      run: |
        echo "ðŸ“ Current directory structure:"
        ls -la
        echo "ðŸ“ Scripts directory:"
        ls -la scripts/ || echo "No scripts directory"
        echo "ðŸ“ GitHub workflows:"
        ls -la .github/workflows/

    - name: Create minimal package.json if missing
      run: |
        if [ ! -f package.json ]; then
          echo "ðŸ“¦ Creating minimal package.json..."
          cat > package.json << EOF
          {
            "name": "climate-zilla",
            "version": "1.0.0",
            "type": "module",
            "scripts": {
              "test": "echo 'No tests yet'"
            }
          }
          EOF
        fi

    - name: Simple health check
      id: health
      run: |
        echo "ðŸŒ Starting Climate-ZiLLA health check..."
        echo "âœ… Node.js: $(node --version)"
        echo "âœ… Current directory: $(pwd)"
        echo "âœ… Files in root: $(ls -la | head -10)"
        echo "ðŸŽ‰ Health check PASSED - System is operational"
        
    - name: Always pass for now
      if: always()
      run: echo "ðŸŸ¡ This step always runs regardless of previous steps"

    - name: Success notification
      if: success()
      run: echo "âœ… CLIMATE-ZILLA HEALTH CHECK COMPLETED SUCCESSFULLY"
